# Log-Signatures in Control: Theory & Intuition

> **Objective**: To provide a formal yet intuitive justification for replacing global Signatures with Log-Signatures in the KRONIC control framework.

## 1. Preliminaries
Let $X_t \in \mathbb{R}^d$ be a control-affine system driven by a path $u_t$:
$$ dX_t = f(X_t) dt + g(X_t) \circ du_t $$
where $\circ$ denotes the Stratonovich integral.

## 2. The Redundancy Conjecture

> **Conjecture 1 (Redundancy of Global Coordinates)**
> The global Signature sequence $S(u)_{0,t} = (1, \int du, \iint du \otimes du, \dots)$ contains redundant information that is algebraically irrelevant for the evolution of the system state $X_t$. Specifically, the symmetric parts of the tensor product correspond to "re-parameterizations" or "excursions" that do not affect the net displacement on a manifold.

### Remark (Intuition)
Imagine parallel parking. To park, you move *forward*, then *backwards*. The net displacement in the "forward-backward" direction is zero. However, the *area* enclosed by your path (steering $\times$ movement) causes a net displacement in the *sideways* direction.
- The **Signature** records "I moved forward 1m, then backward 1m". (Redundant).
- The **Log-Signature** records "I encompassed 1 unit of area". (Minimal).

---

## 3. Algebraic Formalism

### Proposition 1 (The Shuffle Product)
The space of Signatures $\mathcal{T}((\mathbb{R}^d))$ is an algebra equipped with the **shuffle product** $\shuffle$. For any two coordinate iterated integrals $I^\mathbf{i}$ and $I^\mathbf{j}$, their product is a linear combination of higher-order integrals:
$$ I^\mathbf{i} \cdot I^\mathbf{j} = I^{\mathbf{i} \shuffle \mathbf{j}} $$

> **Corollary**: The set of all iterated integrals is not linearly independent.

### Proof (Sketch)
Consider scalar paths $u^1, u^2$.
$$ (\int_0^t du^1) (\int_0^t du^2) = \int_0^t (\int_0^s du^1) du^2 + \int_0^t (\int_0^s du^2) du^1 $$
This is integration by parts. The product of two "level 1" features is a sum of "level 2" features.
Therefore, if our linear model contains all level 2 features, it implicitly contains all products of level 1 features.
This algebraic redundancy explodes combinatorially: $d^k$.

---

## 4. The Log-Signature Proposition

> **Proposition 2 (Lie Algebra Generation)**
> The logarithm of the Signature, $\log S(u)$, takes values strictly in the **Free Lie Algebra** over $\mathbb{R}^d$, denoted $\mathcal{L}((\mathbb{R}^d))$.
> $$ \log S(u) = \sum_{k=1}^\infty \sum_{w \in \mathcal{B}_k} c_w [e_{i_1}, [e_{i_2}, \dots]] $$
> The coefficients $c_w$ are the **Log-Signatures**.

### Proof
By the Baker-Campbell-Hausdorff (BCH) formula, the solution to the differential equation $dY = Y \otimes du$ can be written as $Y_t = \exp(Z_t)$, where $Z_t$ lies in the Lie algebra generated by the tangent vectors of $u$.
Since the Signature is the solution to exactly this universal ODE, $\log S(u)$ must lie in the Lie algebra.

### Remark (Why this matters for Control)
The state of our system evolves on a manifold. The "directions" we can move are defined by the Lie brackets of the vector fields $f$ and $g$ (by Chow-Rashevskii Theorem).
- The **Log-Signature** terms correspond 1-to-1 with these Lie brackets.
- Therefore, the Log-Signature provides the **canonical coordinates** for the controllable subspace of the system.

---

## 5. Validity in CartPole Environment

> **Proposition 3 (Injectivity with Time)**
> If the path $u_t$ is augmented with a strictly monotonic time component $t$, i.e., $\hat{u}_t = (t, u_t)$, then the Log-Signature map $u \mapsto \log S(\hat{u})_{0,t}$ is locally injective (up to tree-like equivalence which is nullified by monotonicity).

### Proof (Intuition)
Standard Log-Signatures are blind to "tree-like" paths (going $A \to B \to A$).
However, physics happens in time. We cannot go $t_0 \to t_1 \to t_0$.
By including time, the path never retraces itself in the full spacetime $\mathbb{R} \times \mathbb{R}^d$.
Thus, the Log-Signature captures the full, unique trajectory.

### Remark (Dimensionality Reduction)
Using Log-Signatures (Lyndon basis) reduces the feature size drastically while keeping the "Lie Bracket" information critical for control (e.g., swinging up).

| Degree | Signature Dim ($d=5$) | Log-Sig Dim ($d=5$) | Reduction |
| :--- | :--- | :--- | :--- |
| 2 | 30 | 15 | 2x |
| 3 | 155 | 45 | **3.4x** |
| 4 | 780 | 150 | **5.2x** |

**Conclusion:** We replace a redundant $O(d^k)$ basis with a minimal $O(Lyndon(d,k))$ basis, maintaining exact algebraic equivalence for the relevant dynamics.
